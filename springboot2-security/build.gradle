/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */

apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'org.springframework.boot'
apply plugin: 'io.spring.dependency-management'
apply plugin: 'com.google.cloud.tools.appengine'

buildscript {
   ext {
       springBootVersion = '2.0.0.RELEASE'
   }
   repositories {
       mavenCentral()
   }
   dependencies {
       classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
       classpath('com.google.cloud.tools:appengine-gradle-plugin:1.3.3')
   }
}

repositories {
   mavenCentral()
}

dependencies {
  compileOnly group: 'javax.servlet', name: 'javax.servlet-api', version: '3.1.0'
  compile("org.springframework.boot:spring-boot-starter-web") {
    exclude group: "org.springframework.boot", module: "spring-boot-starter-tomcat"
  }
  providedRuntime "org.springframework.boot:spring-boot-starter-jetty"
  
  compile("org.springframework.boot:spring-boot-starter-actuator")
  compile("org.springframework.security:spring-security-web:5.0.3.RELEASE")
  compile("org.springframework.security:spring-security-config:5.0.3.RELEASE")
//  compile("org.springframework.security:spring-security-oauth2-client:5.0.3.RELEASE")

  testCompile('junit:junit:4.+')
  testCompile('org.springframework.security:spring-security-test:5.0.3.RELEASE')

  runtime("org.springframework.boot:spring-boot-devtools")
}

explodeWar {
   doLast {
       delete fileTree("build/exploded-${rootProject.name}/WEB-INF/lib") {
           include 'spring-boot-starter-tomcat-*.jar'
           include 'tomcat-embed-*.jar'
           include 'spring-boot-devtools-*.jar'
       }
   }
}
